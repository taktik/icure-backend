{{- if and .Values.tls }}
{{ range .Values.tls }}
{{- if and .provider .credentialsSecretName }}
{{- $tls := . -}}
{{ range .hosts }}
apiVersion: voyager.appscode.com/v1beta1
kind: Certificate
metadata:
  name: {{ . | replace "." "-" }}
spec:
  renewalBufferDays: 25
  domains:
    - {{ . }}
  acmeUserSecretName: acme-account
  challengeProvider:
    dns:
      provider: {{ $tls.provider }}
      credentialSecretName: {{ $tls.credentialsSecretName }}
---
{{- end }}
{{- end }}
{{- end }}
{{- end }}
